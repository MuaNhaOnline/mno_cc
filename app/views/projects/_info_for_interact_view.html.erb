<%
=begin
	params: @project
=end
%>

<section class="heading">
	<h3 class="title">
		<%= @project.project_name %>
		<span class="sub">
			Dự án <%= t("project_type.text.#{@project.project_type.name}").downcase %>
		</span>
	</h3>
</section>

<section class="body">
	<section class="info">
		<% @project.blocks.each do |block| %>
			<a class="link" aria-click="interact" data-type="block" data-value="<%= block.id %>"><%= block.name %></a>
			<ul>
				<li>
					Cấu trúc
					<ul>
						<% block.floors.each do |floor| %>
							<li>
								Tầng <%= floor.floors_text %>:
								<% if floor.is_dynamic %>
									<%
										available_count = 0
										count = 0
										floor.real_estates.each do |re|
											available_count += re.available_in_floors.count
											count += re.in_floors.count
										end
									%>
									<a class="link" aria-click="interact" data-type="blocks/floor" data-value="<%= floor.id %>"><%= floor.name %></a> <small><b>(<%= available_count %>/<%= count %>)</b></small>
								<% else %>
									<%= floor.name %>
								<% end %>
							</li>
						<% end %>
					</ul>
				</li>
			</ul>
			<ul>
				<li>
					Gồm
					<ul>
						<% block.real_estate_groups.each do |group| %>
							<%
								available_count = 0
								count = 0
								group.real_estates.each do |re|
									available_count += re.available_in_floors.count
									count += re.in_floors.count
								end
							%>
							<li>
								<a class="link" aria-click="interact" data-type="real_estates/group" data-value="<%= group.id %>"><%= group.name %></a> <small><b>(<%= available_count %>/<%= count %>)</b></small>
							</li>
						<% end %>
					</ul>
				</li>
			</ul>
		<% end %>
	</section>
	
</section>