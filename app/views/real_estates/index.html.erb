<% content_for :stylesheets do %>
	<link rel="stylesheet" href="/assets/real_estates/index.css" />
	<link rel="stylesheet" href="/assets/shared/ion.rangeSlider.skinFlat.css" />
	<link rel="stylesheet" href="/assets/shared/ion.rangeSlider.css" />
	<link rel="stylesheet" href="/assets/shared/normalize.css" />
<% end %>

<% content_for :scripts do %>
	<script src="/assets/shared/ion.rangeSlider.min.js"></script>
	<script src="/assets/real_estates/index.js"></script>
<% end %>

<% 
	per = get_value_by_width_type [1, 2, 3, 4]
%>

<!--start Search Box -->
<section class="search">
	<div class="search-box">
		<div class="title">
			<h3>Hãy để MuanhaOnline tìm nhà giúp bạn.</h3>
		</div>
		<form>
			<div class="tab">
				<label><input type="radio" name="typeTab"><i class="icon-32 icon-home-sale"></i><span>Nhà Bán</span></label>
				<label><input type="radio" name="typeTab"><i class="icon-32 icon-home-rent"></i><span>Nhà Thuê</span></label>       
			</div>
			<div class="form-group-custom">
				<input type="text" class="form-control search-keyword" placeholder="... nhà phố quận 2">
				<div class="btn-group history-search">
					<button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
						từ khóa
					</button>
					<ul class="dropdown-menu" role="menu">
						<li><a href="#">Từ khóa 01</a></li>
						<li><a href="#">Từ khóa 02</a></li>
						<li><a href="#">Từ khóa 03</a></li>
					</ul>
				</div>
				<div class="separator">
					<span>|</span>
				</div>
				<div class="btn-search">
					<button type="submit"></button>
					<div class="btn-more" data-function="show-search-plus">
						<span class="caret"></span>
					</div>
				</div>
			</div>			
			<section class="more-search" id="more_search" style="display:none">
				<div class="form-group-custom container-fluid">
					<div class="row">
						<div class="col-md-6 input-inline">
						<select class="form-control input-sm">
						<option>--Chọn thành phố/Tỉnh--</option>
						<option>Thành phố Hồ Chí Minh</option>
						<option>Hà Nội</option>
						<option>Bà Rịa - Vũng Tàu</option>
						</select>
						</div>
						<div class="col-md-6">
						<select class="form-control input-sm">
						<option>--Chọn quận/huyện--</option>
						<option>Quận 1</option>
						<option>Quận 5</option>
						</select>
						</div>
					</div>
				</div>
				<div class="form-group-custom">
					<select class="form-control input-sm">
						<option>--Chọn giá tiền--</option>
						<option>1 tỷ - 3 tỷ</option>
						<option>3 tỷ - 5 tỷ</option>
						<option>trên 5 tỷ</option>
					</select>
				</div>
				<div class="form-group-custom">
					<select class="form-control input-sm">
						<option>--Chọn diện tích--</option>
						<option>50m2 - 100m2</option>
						<option>100m2 - 200m2</option>
						<option>trên 200m2</option>
					</select>
				</div>
				<div class="form-group-custom container-fluid">
					<div class="row">
						<div class="col-md-6 input-inline">
							<select class="form-control input-sm">
								<option>--Chọn loại dự án--</option>
								<option>Dự án căn hộ liên kế</option>
								<option>Dự án biệt thự cao cấp</option>
								<option>Dự án nhà ở xã hội</option>
							</select>
						</div>
						<div class="col-md-6 input-inline">
							<select class="form-control input-sm">
								<option>--Chọn tình trạng dự án--</option>
								<option>Dự án đã hoàn thành</option>
								<option>Dự án đang hoàn thành</option>
							</select>
						</div>
					</div>
				</div>
				<div class="form-group">
					
				</div>
			</section>
			<div class="btn-plus">
				<button type="submit" class="btn btn-success btn-sm btn-search-plus">
					<img src="/assets/icon/search-plus.png">
					Tìm nâng cao
				</button>
				<button type="button" class="btn btn-success btn-sm" data-function="zestimate" data-popup="coming-soon">Định giá khu vực này</button>
			</div>
		</form>
	</div>
</section>
<!-- end Search Box-->

<!-- start navigator -->
<section class="navigator container">
	<ol class="breadcrumb">
		<li><a href="/">Trang chủ</a></li>
		<li class="active">Bất động sản đang rao</li>
	</ol>
</section>
<!-- end navigator -->

<!-- start favorite-property -->
<section class="container block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Bất động sản được yêu thích</span>
		</a>
	</article>
	<article class="content">
		<section class="slick favorite-property">
			<div class="content">
				<%
					res = RealEstate.search_with_params(is_favorite: 'true').random.limit 3
				%>
				<%= render partial: 'real_estates/item_list', locals: { res: res, type: 2 } %>
			</div>
			<button class="slider-control prev" id="favor-prev"></button>
			<button class="slider-control next" id="favor-next"></button>
		</section>
		<section class="user-property">		
			<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
				<li class="active">
					<a href="#suggest_property" role="tab" data-toggle="tab">
						Có thể bạn quan tâm
					</a>
				</li>
				<li>
					<a href="#new_property" role="tab" data-toggle="tab">
						Bất động sản mới rao bán
					</a>
				</li>
			</ul>
			<!-- end -->

			<!-- Tab panes -->
			<div class="tab-content">
				<div aria-pagination data-url="/real_estates/search" data-data='{"per":<%= per %>}' data-list="#suggest_property > .row" data-pagination="#suggest_property > .paging" data-init_list="_initItemList($list)" class="tab-pane fade in active" id="suggest_property">
					<%
						res = RealEstate.search_with_params
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per, total: res.count, page: 1 } %>						
					</div>
				</div>
				<div aria-pagination data-url="/real_estates/search" data-data='{"per":<%= per %>}' data-list="#new_property > .row" data-pagination="#new_property > .paging" data-init_list="_initItemList($list)" class="tab-pane fade" id="new_property">
					<%
						res = RealEstate.search_with_params
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per, total: res.count, page: 1 } %>						
					</div>
				</div>
			</div>
			<!-- end -->
		</section>
	</article>
</section>
<!-- end favorite-property -->

<!-- start structure-property -->
<section class="container structure-property block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Bất động sản theo kết cấu</span>
		</a>
	</article>
	<article class="content">
		<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
				<li class="active">
					<a href="#property" role="tab" data-toggle="tab">
						Nhà phố
					</a>
				</li>
				<li>
					<a href="#villa" role="tab" data-toggle="tab">
						Villa - Biệt thự
					</a>
				</li>
				<li>
					<a href="#apartment" role="tab" data-toggle="tab">
						Căn hộ
					</a>
				</li>
				<li>
					<a href="#ground" role="tab" data-toggle="tab">
						Mặt bằng
					</a>
				</li>
				<li>
					<a href="#land" role="tab" data-toggle="tab">
						Đất
					</a>
				</li>
			</ul>
			<!-- end -->

			<!-- Tab panes -->
			<div class="tab-content">
				<% 
					per_2_row = get_value_by_width_type [1, 4, 6, 8] 
				%>
				<div aria-pagination data-url="/real_estates/search" data-data='{"real_estate_type":"town_house","per":<%= per_2_row %>}' data-list="#property > .row" data-pagination="#property > .paging" data-init_list="_initItemList($list)" class="tab-pane fade in active" id="property">
					<%
						res = RealEstate.search_with_params real_estate_type: 'town_house'
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per_2_row) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per_2_row, total: res.count, page: 1 } %>						
					</div>
				</div>
				<div aria-pagination data-url="/real_estates/search" data-data='{"real_estate_type":"villa","per":<%= per_2_row %>}' data-list="#villa > .row" data-pagination="#villa > .paging" data-init_list="_initItemList($list)" class="tab-pane fade" id="villa">
					<%
						res = RealEstate.search_with_params real_estate_type: 'villa'
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per_2_row) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per_2_row, total: res.count, page: 1 } %>						
					</div>
				</div>
				<div aria-pagination data-url="/real_estates/search" data-data='{"real_estate_type":"apartment","per":<%= per_2_row %>}' data-list="#apartment > .row" data-pagination="#apartment > .paging" data-init_list="_initItemList($list)" class="tab-pane fade" id="apartment">
					<%
						res = RealEstate.search_with_params real_estate_type: 'apartment'
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per_2_row) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per_2_row, total: res.count, page: 1 } %>						
					</div>
				</div>
				<div aria-pagination data-url="/real_estates/search" data-data='{"real_estate_type":"space","per":<%= per_2_row %>}' data-list="#ground > .row" data-pagination="#ground > .paging" data-init_list="_initItemList($list)" class="tab-pane fade" id="ground">
					<%
						res = RealEstate.search_with_params real_estate_type: 'space'
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per_2_row) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per_2_row, total: res.count, page: 1 } %>						
					</div>
				</div>
				<div aria-pagination data-url="/real_estates/search" data-data='{"real_estate_type":"land","per":<%= per_2_row %>}' data-list="#land > .row" data-pagination="#land > .paging" data-init_list="_initItemList($list)" class="tab-pane fade" id="land">
					<%
						res = RealEstate.search_with_params real_estate_type: 'land'
					%>
					<div class="row">
						<%= render partial: 'real_estates/item_list', locals: { res: res.take(per_2_row) } %>
					</div>
					<div class="paging">
						<%= render partial: 'shared/pagination_2', locals: { per: per_2_row, total: res.count, page: 1 } %>						
					</div>
				</div>
			</div>
			<!-- end -->
	</article>
</section>
<!-- end -->

<!-- start position property -->
<section class="container position-property block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Bất động sản theo vị trí</span>
		</a>
	</article>
	<article class="sub-title">
		<div class="row">
			<div class="col-sm-10">
				<span>Danh sách bất động sản tại </span>
				<div class="btn-group">
					<div class="btn-group">
						<a class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
							Thành phố Hồ Chí Minh<span class="caret" style="margin-left: 5px; vertical-align: 2px"></span>
						</a>
						<ul class="dropdown-menu">
							<% 
								districts = District.order name: 'asc'
							%>
							<% districts.each do |district| %>
								<li>
									<a aria-click="position_change" data-value="<%= district.id %>" href="javascript:void(0)"><%= district.name %></a>
								</li>
							<% end %>
						</ul>
					</div>
				</div>
			</div>
			<div class="col-sm-2">
				<div class="link">
					<a href="/real_estates" class="btn btn-default btn-sm btn-custom-default">Xem nhiều hơn</a>
				</div>
			</div>
		</div>
	</article>
	<article class="content">		
		<%
			res = RealEstate.search_with_params district: districts.first.id
		%>
		<div id="position_list" class="row">
			<%= render partial: 'real_estates/item_list', locals: { res: res.take(per) } %>
		</div>
		<div id="position_pagination" class="paging">
			<%= render partial: 'shared/pagination_2', locals: { per: per, total: res.count, page: 1 } %>						
		</div>
	</article>
</section>
<!-- end position property -->

<!-- start price property -->
<section class="container price-property block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Tìm kiếm theo giá</span>
		</a>
	</article>
	<article class="content">
		<% if current_purpose == 'r' %>
			<input type="text" id="slider" data-from="0" data-to="5000000" data-min="0" data-max="10000000" data-step="500000" data-keyboard_step="500000" data-min_interval="2000000" data-per="<%= per %>" />
			<% 
				res = RealEstate.search_with_params price: '0;5000000'
			%>
		<% else %>
			<input type="text" id="slider" data-from="0" data-to="2000000000" data-min="0" data-max="3000000000" data-step="1000000" data-keyboard_step="500000000" data-min_interval="300000000" data-per="<%= per %>" />
			<% 
				res = RealEstate.search_with_params price: '0;2000000000'
			%>
		<% end %>
		<ul id="price_list" class="row" style="margin-top: 15px;">			
			<%= render partial: 'real_estates/item_list', locals: { res: res.take(per) } %>
		</ul>
		<div id="price_pagination" class="paging">
			<%= render partial: 'shared/pagination_2', locals: { per: per, total: res.count, page: 1 } %>
		</div>
	</article>
</section>
<!-- end -->

<!-- start short property -->
<section class="container short-property block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Tin nhanh</span>
		</a>
	</article>
	<article class="content row">
		<div class="col-md-6">
			<%
				res = RealEstate.search_with_params(is_full: 'false').limit(5)
			%>
			<% res.each do |re| %>
				<li class="item-xs" data-toggle-object="idMe<%= re.id %>">
					<div class="title" >
						<div class="date" aria-time="<%= re.created_at %>"></div>
						<div class="text">
							<span><%= re.title %></span>
							<i class="fa fa-caret-down"></i>
						</div>
					</div>
					<div class="content-item-xs" data-object="idMe<%= re.id %>" style="display: none;">
						<div class="title">
							<div class="date" aria-time="<%= re.created_at %>"></div>
							<div class="text">
								<span>
									<%= re.title %>
								</span>							
							</div>
						</div>
						<div class="details">
							<div class="info">
								<span class="poster">Người đăng</span>
								<span class="name"><%= re.display_user_name %></span>
								<span class="type-contact">Liên hệ</span>
								<span class="infocontact"><%= re.display_user_phone_number || re.display_user_email %></span>
							</div>
							<div class="text">
								<%= re.description.html_safe %>
							</div>
						</div>
					</div>
				</li>
			<% end %>
		</div>
	</article>
</section>
<!-- end short property -->

<!-- start propensity property -->
<section class="propensity-property container block">
	<article class="title">
		<a href="#" class="link">
			<i class="fa fa-link"></i>
			<span>Danh sách tổng hợp</span>
		</a>
	</article>
	<div class="row">
		<% 
			re = RealEstate.search_with_params(real_estate_type: 'town_house').first 
		%>
		<% if re.present? %>
			<div class="col-md-6">
				<div class="item-general">
					<a href="#">
						<%= real_estate_avatar re, style_class: 'img-responsive img-thumbnail', style: 'slide' %>
						<div class="name">
							<span>Nhà ở xã hội</span>
						</div>
					</a>
				</div>
			</div>
		<% end %>
		<% 
			re = RealEstate.search_with_params(real_estate_type: 'villa').first 
		%>
		<% if re.present? %>
			<div class="col-md-6">
				<div class="item-general">
					<a href="#">
						<%= real_estate_avatar re, style_class: 'img-responsive img-thumbnail', style: 'slide' %>
						<div class="name">
							<span>Biệt thự cao cấp</span>
						</div>
					</a>
				</div>
			</div>
		<% end %>
		<% 
			re = RealEstate.search_with_params(real_estate_type: 'apartment').first 
		%>
		<% if re.present? %>
			<div class="col-md-6">
				<div class="item-general">
					<a href="#">
						<%= real_estate_avatar re, style_class: 'img-responsive img-thumbnail', style: 'slide' %>
						<div class="name">
							<span>Căn hộ cao cấp</span>
						</div>
					</a>
				</div>
			</div>
		<% end %>
		<% 
			re = RealEstate.search_with_params(real_estate_type: 'town_house', cheapest: nil).first 
		%>
		<% if re.present? %>
			<div class="col-md-6">
				<div class="item-general">
					<a href="#">
						<%= real_estate_avatar re, style_class: 'img-responsive img-thumbnail', style: 'slide' %>
						<div class="name">
							<span>Nhà phố giá rẻ</span>
						</div>
					</a>
				</div>
			</div>
		<% end %>
	</div>
</section>
<!-- end propensity property -->

<!-- start contact -->
<section class="contact block container">
	<article class="title">
		<a>
			<span>Liên hệ MuaNhaOnline.vn</span>
		</a>
	</article>
	<article class="content">
		<div class="row">
			<div class="col-md-2 col-sm-3 col-xs-6">
				<img src="/assets/contact/contact01.jpg" class="img-responsive">
			</div>
			<div class="col-md-3 col-sm-3 col-xs-6">
				<%= render partial: 'questions/form_front' %>
			</div>
			<div class="col-md-7 question col-sm-6">
				<div class="panel-group" id="accordion">
					<% 
						questions = Question.get_pinned 
					%>
					<%= render partial: 'questions/item_list_front', locals: { questions: questions } %>
				</div>
			</div>
	</article>
</section>
<!-- end contact -->